# review_report_url: https://hunt.io/blog/latrodectus-malware-masquerades-as-ahnlab-security-software-to-infect-victims
# review_date: 2024-11-06
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - This Sigma rule detects SSL/TLS handshakes involving certificates issued by "Internet Widgits Pty Ltd" with a Common Name (CN) of "localhost," which are indicative of Latrodectus malware's command and control (C2) activity. It focuses on SSL/TLS traffic analyzed by Zeek with the X.509 service, flagging certificates that match these attributes. False positives may occur if legitimate software uses the same issuer and CN for self-signed certificates. The rule is marked as medium severity, as this behavior is suspicious but not necessarily malicious on its own.
title: Detection of Latrodectus Malware SSL Certificate Attributes
id: b9c191ce-69ce-46e1-b88d-c317339bb462
status: experimental
description: Detects SSL/TLS handshakes with certificates issued by 'Internet Widgits Pty Ltd' with a Common Name of 'localhost', which are indicators of Latrodectus malware C2 activity.
references:
  - https://hunt.io/blog/latrodectus-malware-masquerades-as-ahnlab-security-software-to-infect-victims
author: System Two Security
date: 2024/09/04
tags:
  - attack.command-and-control
logsource:
  product: zeek
  service: x509
detection:
  selection:
    certificate.serial|contains|all:
      - localhost
      - Internet Widgits Pty Ltd
  condition: selection
falsepositives:
  - Legitimate software that uses the same issuer and common name for self-signed certificates
level: medium
