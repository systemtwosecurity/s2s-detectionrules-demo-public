# review_report_url: https://cloud.google.com/blog/topics/threat-intelligence/apt41-us-state-governmentss 
# review_date: 2024-11-03
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  -  This Sigma rule detects the BADPOTATO malware on Windows systems by matching specific MD5, SHA1, and SHA256 hashes. It relies on logs capturing executable file detections. False positives are rare due to the unique nature of the hashes, but hash collisions with benign files are a slight possibility.
title: Detection of BADPOTATO Malware Family
id: 2a061884-fb8d-4adc-99bf-ca0691e4b4d3
status: experimental
description: Detects the presence of BADPOTATO malware based on specific MD5, SHA1, and SHA256 hashes.
references:
  - https://cloud.google.com/blog/topics/threat-intelligence/apt41-us-state-governments
author: System Two Security
date: 2024/10/25
tags:
  - attack.execution
logsource:
  product: windows
  category: file_executable_detected
detection:
  selection:
    Hashes|contains:
      - 143278845a3f5276a1dd5860e7488313
      - 6f6b51e6c88e5252a2a117ca1cfb57934930166b
      - a4647fcb35c79f26354c34452e4a03a1e4e338a80b2c29db97bba4088a208ad0
  condition: selection
falsepositives:
  - Unknown. As the hashes are specific to the malware, false positives are unlikely but possible if the hashes collide with benign files.
level: critical
