# review_report_url: https://www.threatdown.com/blog/gootloader-05-23-2024/
# review_date: 2024-10-23
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - The sigma rule "Gootloader Two-Stage Malware Delivery Detection" aligns closely with the CTI report. It identifies Gootloader's infection chain, where a smaller initial request to clintkustoms[.]com/manual.php (3.6 KB) is followed by a larger JavaScript payload (1.9 MB) from the same URL. This pattern matches Gootloaderâ€™s multi-stage delivery strategy to evade detection.
title: Gootloader Two-Stage Malware Delivery Detection
id: b3488574-60a2-493e-bf46-c3554af89e00
status: experimental
description: Detects a two-stage malware delivery process where a small file is followed by a large JavaScript payload from the same URL, which could indicate a Gootloader infection.
references:
  - https://www.threatdown.com/blog/gootloader-05-23-2024
author: System Two Security
date: 2024/10/11
tags:
  - attack.execution
logsource:
  product: zeek
  service: http
detection:
  selection_small:
    uri: /manual.php
    method: GET
    status_code: '200'
    request_body_len: '3686'
  selection_large:
    uri: /manual.php
    method: GET
    status_code: '200'
    request_body_len|startswith: '1900'
  condition: selection_small and selection_large
falsepositives:
  - Legitimate software updates or content delivery with similar behavior
  - CDNs or load balancers serving variable content sizes
level: high
