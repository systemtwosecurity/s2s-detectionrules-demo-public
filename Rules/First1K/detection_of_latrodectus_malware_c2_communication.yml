# review_report_url: https://www.netskope.com/blog/latrodectus-rapid-evolution-continues-with-latest-new-payload-features
# review_date: 2024-11-05
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - This Sigma rule detects Latrodectus malware C2 communication by identifying specific HTTP POST requests with the User-Agent string "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1)" sent to the URI path "/test/". This particular combination is rare in legitimate applications today, especially given the outdated User-Agent string, which is commonly associated with malicious activity or emulated environments. The rule flags these indicators with a high alert level, acknowledging a small chance of false positives from legacy software.
title: Detection of Latrodectus Malware C2 Communication
id: 6ed11b33-974b-4eb0-a7fa-532356cec220
status: experimental
description: Detects HTTP POST requests with a specific User-Agent string indicative of Latrodectus malware C2 communication.
references:
  - https://www.netskope.com/blog/latrodectus-rapid-evolution-continues-with-latest-new-payload-features
author: System Two Security
date: 2024/09/19
tags:
  - attack.command-and-control
  - attack.t1071.001
logsource:
  category: application
  product: modsecurity
detection:
  selection:
    c-uri: /test/
    c-request:
      User-Agent|contains: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1)
  condition: selection
falsepositives:
  - Legitimate applications with outdated User-Agent strings
level: high
