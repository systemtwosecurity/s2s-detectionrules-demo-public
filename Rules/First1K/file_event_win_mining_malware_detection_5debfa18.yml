# review_report_url: https://www.antiy.com/response/HideShoveling.html
# review_date: 2024-11-12
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - This Sigma rule detects file events associated with known mining malware by monitoring for the presence of specific files identified in a CTI report. The rule triggers on files such as oci.dll, aswArPots.sys, run.bat, and other known malware-related files commonly found in targeted directories. By identifying these files, this rule helps detect early signs of mining malware installation or execution, enabling security teams to take proactive measures against potential malicious activity.
title: Detection of Mining Malware File Activity
id: 5debfa18-b805-4e6f-beb6-c6a88df33b2d
status: experimental
description: Detects the presence of files associated with a known mining malware as specified in the CTI report.
references:
  - https://www.antiy.com/response/HideShoveling.html
author: System Two Security
date: 2024/10/26
tags:
  - attack.t1496
  - attack.resource-development
logsource:
  product: windows
  category: file_event
detection:
  selection1:
    TargetFilename|contains:
      - C:\Windows\System32\oci.dll
      - C:\Windows\System32\drivers\aswArPots.sys
      - C:\Users\Public\run.bat
      - C:\Windows\Fonts\smartsscreen.exe
  selection2:
    TargetFilename|endswith:
      - \WinRing0x32.sys
      - \config.json
      - \WinRing0x64.sys
      - \IObitUnlockers.sys
      - \curl.exe
      - \taskhostw.exe
  condition: selection1 or selection2
falsepositives:
  - Legitimate use of similarly named files in the specified paths
level: high
