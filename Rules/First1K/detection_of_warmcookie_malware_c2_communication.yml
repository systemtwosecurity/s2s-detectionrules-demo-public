# review_report_url:https://www.elastic.co/security-labs/dipping-into-danger
# review_date: 2024-10-07
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - This detection aligns with the CTI report on WARMCOOKIE malware, identifying HTTP communication with 185.49.69.41 and the use of RC4 and Base64 encoding in HTTP cookie parameters. The initial request matches the described structure, including user-agent and custom field values.
title: Detection of WARMCOOKIE Malware C2 Communication
id: a0e70b71-0556-4c7c-a88b-b183d6548f37
status: experimental
description: Detects the initial request to the C2 server with a custom structure through an HTTP cookie parameter as used by the WARMCOOKIE malware.
references:
  - https://www.elastic.co/security-labs/dipping-into-danger
author: System Two Security
date: 2024/10/02
tags:
  - attack.command-and-control
logsource:
  product: windows
  service: iis
detection:
  selection:
    cs-method: GET
    cs-uri-stem: /
    cs-host: 185.49.69.41
    cs-user-agent|startswith: Mozilla / 4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1;.NET CLR 1.0.3705)
    cs-cookie|contains: x41OYTpmEwUUKm2AvnkS2onu1XqjP6shVvosIXkAD957a9RplEGFsUjR8f/lP1O8EERtf+idl0bimsKh8mRA7+dL0Yk09SwgTUKBu9WEK4RwjhkYuxd2JGXxhlA=
  condition: selection
falsepositives:
  - Legitimate applications that use RC4 and Base64 encoding for their HTTP cookie parameters in a similar format
level: high
