# review_report_url: https://blog.lumen.com/taking-the-crossroads-the-versa-director-zero-day-exploitation/
# review_date: 2024-10-18
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - The sigma rule correctly detects the pgrep command used by TestMain.class to identify the Apache Tomcat Bootstrap process, as detailed in the CTI report. This behavior is a key step in the Versa Director Zero-Day exploitation. The rule is aligned with the CTI report and ready for testing, with minor consideration for false positives from legitimate administrative queries.
title: Detection of Versa Director Zero-Day Exploitation via TestMain.class
id: bf691a7d-517e-442c-9f91-2aaf135218a1
status: experimental
description: Detects the execution of a specific pgrep command used to identify the process with the Bootstrap loader for an actively running Apache Tomcat service, which is indicative of the Versa Director Zero-Day exploitation as described in the CTI report.
references:
  - https://blog.lumen.com/taking-the-crossroads-the-versa-director-zero-day-exploitation
author: System Two Security
date: 2024/10/11
tags:
  - attack.execution
logsource:
  product: linux
  service: auditd
detection:
  keywords: /usr/bin/pgrep -f org.apache.catalina.startup.Bootstrap
  condition: keywords
falsepositives:
  - Legitimate administrative activities that involve querying the process list for Apache Tomcat.
level: high
