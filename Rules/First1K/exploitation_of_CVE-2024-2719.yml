# review_report_url: https://darktrace.com/blog/gootloader-malware-detecting-and-containing-multi-functional-threats-with-darktrace
# review_date: 2024-09-21
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: na
# review_notes:
#  - This rule aims to detect suspicious HTTP GET requests attempting to exploit CVE-2024-27198. The focus is on identifying requests made with a specific user agent (python-requests/2.25.1) from a designated source IP (83.97.20.141). Also it is highly specific, reducing the chance of noise by focusing on a combination of factors: IP address, user agent, and targeted URIs. This makes the rule very focused on the scenario described and should reduce unnecessary alerts. The use of a specific IP (83.97.20.141) for this detection narrows the potential for false positives but also limits detection of attacks from other IP addresses. The reference url mentioned in the file is not relevant to this detection.  You can use this url: https://www.trendmicro.com/en_us/research/24/c/teamcity-vulnerability-exploits-lead-to-jasmin-ransomware.html

title: Exploitation of CVE-2024-27198 via TeamCity
id: ddf91f0c-2eaa-4d7d-a5bf-1957a29c3380
status: experimental
description: Detects suspicious HTTP requests to URIs that exploit CVE-2024-27198 with a specific user agent indicating the use of Python for the attack.
references:
  - https://darktrace.com/blog/gootloader-malware-detecting-and-containing-multi-functional-threats-with-darktrace
author: System Two Security
date: 2024/08/21
tags:
  - attack.initial_access
logsource:
  category: application
  product: modsecurity
detection:
  selection:
    SrcIP: 83.97.20.141
    HttpRequestMethod: GET
    UserAgent|contains: python-requests/2.25.1
    HttpUri|contains|all:
      - /hax?jsp=/app/rest/server
      - /hax?jsp=/app/rest/users
  condition: selection
falsepositives:
  - Legitimate use of Python-requests user agent from the specified IP to access the application, which is unlikely and should be validated.
level: high