# review_report_url: https://cloud.google.com/blog/topics/threat-intelligence/apt41-us-state-governments
# review_date: 2024-11-03
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - This Sigma rule detects the creation of a webshell via a deserialization exploit, specifically looking for the use of File.WriteAllBytes to write a file (e.g., shell.aspx) to the web server directory. It flags potential persistence tactics used by APT41.
title: APT41 Writing Webshell to Disk via Deserialization Exploit
id: 35267b1f-39a5-40b6-9b22-b7d81bd4fa75
status: experimental
description: Detects the writing of a webshell to disk using File.WriteAllBytes method in a deserialization exploit as used by APT41.
references:
  - https://cloud.google.com/blog/topics/threat-intelligence/apt41-us-state-governments
author: System Two Security
date: 2024/10/25
tags:
  - attack.persistence
logsource:
  product: windows
  category: file_event
detection:
  selection:
    CommandLine|contains|all:
      - c:\\inetpub\\wwwroot\\shell.aspx
      - File.WriteAllBytes
  condition: selection
falsepositives:
  - Legitimate administrative activity that uses File.WriteAllBytes to write files to the web directory.
level: high
