# review_report_url: https://www.microsoft.com/en-us/security/blog/2022/04/12/tarrask-malware-uses-scheduled-tasks-for-defense-evasion/
# review_date: 2024-10-07
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - This Sigma rule detects Ligolo malware by identifying files with specific names or a known SHA256 hash. It checks for filenames like ngcsvc.exe, proxy.zip, and others, as well as the associated malware hash. Detection of these indicators suggests potential command-and-control activity. False positives are rare but could occur if legitimate software uses matching file names or the same hash.
title: Detection of Ligolo Malware by SHA256 and File Names
id: ae024666-5ae2-4be9-ba24-d489f3bbb1f6
status: experimental
description: Detects the presence of files associated with Ligolo malware based on SHA256 hash and file names.
references:
  - https://www.microsoft.com/en-us/security/blog/2022/04/12/tarrask-malware-uses-scheduled-tasks-for-defense-evasion
author: System Two Security
date: 2024/08/24
tags:
  - attack.command-and-control
logsource:
  product: windows
  category: image_load
detection:
  selection:
    Image|endswith:
      - \ngcsvc.exe
      - \Unique.exe
      - \proxy.zip
      - \ligolo_windows_amd64.exe
      - \WinSvc.exe
      - \ScriptRun.exe
      - \ldaputility.exe
      - \cert.exe
      - \wshqos.exe
      - \winsrv.exe
      - \windowsvc.exe
    sha256: a3baacffb7c74dc43bd4624a6abcd1c311e70a46b40dcc695b180556a9aa3bb2
  condition: selection
falsepositives:
  - Legitimate software that coincidentally has a file name listed in the IOCs.
level: high
