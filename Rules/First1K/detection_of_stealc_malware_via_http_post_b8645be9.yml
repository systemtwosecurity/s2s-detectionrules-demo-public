# review_report_url: https://blog.sekoia.io/stealc-a-copycat-of-vidar-and-raccoon-infostealers-gaining-in-popularity-part-1
# review_date: 2024-12-03
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - This Sigma rule detects HTTP POST requests to PHP files with `multipart/form-data` content containing `token` and `message` fields, indicative of Stealc malware activity, using ModSecurity logs. It is flagged as high severity, with potential false positives from legitimate POST requests with similar field names not related to Stealc malware.
title: Detection of Stealc Malware via HTTP POST
id: b8645be9-942b-4a67-b965-b53161e6c04d
status: experimental
description: Detects HTTP POST requests to a PHP file with multipart/form-data content related to "token" and "message" fields, which may indicate Stealc malware activity.
references:
  - https://blog.sekoia.io/stealc-a-copycat-of-vidar-and-raccoon-infostealers-gaining-in-popularity-part-1
author: System Two Security
date: 2024/11/15
tags:
  - attack.command-and-control
logsource:
  category: application
  product: modsecurity
detection:
  selection:
    RequestMethod: POST
    RequestURI|endswith: .php
    RequestContentType: multipart/form-data
    RequestBody|contains|all:
      - 'Content-Disposition: form-data; name="token"'
      - 'Content-Disposition: form-data; name="message"'
  condition: selection
falsepositives:
  - Legitimate multipart/form-data POST requests with similar fields that are not related to Stealc malware
level: high
