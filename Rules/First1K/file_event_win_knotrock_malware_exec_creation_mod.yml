# review_report_url: https://cloud.google.com/blog/topics/threat-intelligence/unc4393-goes-gently-into-silentnight/
# review_date: 2024-09-21
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - This Sigma rule detects the creation or modification of executable files associated with the KNOTROCK malware family by monitoring specific Windows Event IDs and checking for the presence of PE file headers. By focusing on these indicators, the rule minimizes false positives while ensuring effective detection of potentially malicious activities.
title: Detection of KNOTROCK Malware Family Executable File Creation or Modification
id: 5c468a4e-71bc-4d01-a045-c352980518d8
status: experimental
description: Detects the creation or modification of executable files associated with the KNOTROCK malware family, as identified by specific strings and PE file headers.
references:
  - https://cloud.google.com/blog/topics/threat-intelligence/unc4393-goes-gently-into-silentnight
author: System Two Security
date: 2024/09/20
tags:
  - attack.persistence
logsource:
  product: windows
  category: file_event
detection:
  selection:
    EventID:
      - 2
      - 11
    MagicHeader: '0x5A4D'
    TargetFilename|endswith: .exe
  filter:
    Image|endswith: b2af1cd157221f240ce8f8fa88bf6d44
  condition: selection and not filter
falsepositives:
  - Legitimate executable file creation or modification by trusted applications
level: high
