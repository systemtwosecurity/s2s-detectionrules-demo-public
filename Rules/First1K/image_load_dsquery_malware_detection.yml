# review_report_url: https://cloud.google.com/blog/topics/threat-intelligence/apt41-us-state-governments
# review_date: 2024-11-03
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - This Sigma rule detects the DSQUERY malware family based on specific MD5, SHA1, and SHA256 hashes. A false negative may occur if a hash collision happens or if legitimate software coincidentally shares these hash values. However, this is highly unlikely due to the uniqueness of these hashes.

title: Detection of DSQUERY Malware Family
id: 4d96caeb-09f8-4c62-b17e-891f87e40bbc
status: experimental
description: Detects the DSQUERY malware family using specific MD5, SHA1, and SHA256 hashes.
references:
  - https://cloud.google.com/blog/topics/threat-intelligence/apt41-us-state-governments
author: System Two Security
date: 2024/10/25
tags:
  - attack.execution
logsource:
  product: windows
  category: image_load
detection:
  selection:
    Hashes|contains:
      - b108b28138b93ec4822e165b82e41c7a
      - 49f1daea8a115dd6fce51a1328d863cf
    sha1|contains:
      - e85427af661fe5e853c8c9398dc46ddde50e2241
      - 7056b044f97e3e349e3e0183311bb44b0bc3464f
    sha256|contains:
      - ebf28e56ae5873102b51da2cc49cbbe43192ca2f318c4dfc874448d9b85ebd00
      - 062a7399100454c7a523a938293bef7ddb0bc10636ed402be5f9797d8cc3c57e
  condition: 1 of selection
falsepositives:
  - Hash collisions or legitimate software that happens to have the same hash values (extremely unlikely)
level: high
