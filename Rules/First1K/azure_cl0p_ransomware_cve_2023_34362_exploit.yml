# review_report_url: https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-158a
# review_date: 2024-10-26
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - The Sigma rule aligns with key indicators from the CTI report, effectively targeting potential malicious activity tied to the CL0P ransomware group’s exploitation of CVE-2023-34362 within MOVEit Transfer systems. Specifically, the rule's focus on SQL queries accessing Azure system settings and file metadata mirrors the CTI report's description of CL0P’s tactics for data retrieval and exfiltration. The SQL query pattern and Azure activity log source filter in the Sigma rule are well-suited to detect suspicious access attempts, particularly those involving SQL injection-based attacks on MOVEit’s Azure SQL backends.

title: CL0P Ransomware Gang Exploits CVE-2023-34362 MOVEit Vulnerability
id: e3ce37c7-8a94-4ebe-a495-27495f34fffe
status: experimental
description: Detects the retrieval of Microsoft Azure system settings using a specific SQL query associated with the CL0P ransomware group exploiting CVE-2023-34362.
references:
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-158a
author: System Two Security
date: 2024/10/25
tags:
  - attack.persistence
logsource:
  product: azure
  service: activitylogs
detection:
  selection:
    OperationNameValue|contains: select f.id, f.instid, f.folderid, filesize, f.Name as Name, u.LoginName as uploader, fr.FolderPath , fr.name as fname from folders fr, files f left join users u on f.UploadUsername = u.Username where f.FolderID = fr.ID
  condition: selection
falsepositives:
  - Legitimate use of the specific SQL query by authorized personnel for maintenance or reporting purposes.
level: high
