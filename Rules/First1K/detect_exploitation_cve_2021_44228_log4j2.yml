# review_report_url: https://argonsys.com/microsoft-cloud/library/onyx-sleet-uses-array-of-malware-to-gather-intelligence-for-north-korea/
# review_date: 2024-10-27
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - This Sigma rule identifies exploitation attempts of the Log4j 2 vulnerability (CVE-2021-44228) by detecting suspicious JNDI patterns commonly seen in exploit attempts. It specifically monitors for jndi: protocols like ldap, rmi, and dns in application logs for Java Virtual Machine (JVM) environments. Legitimate JNDI lookups might trigger false positives, so monitoring context is recommended.
title: Detect Exploitation of CVE-2021-44228 (Log4j 2)
id: 26b0fc24-3cfd-4108-9a6b-817c0499e0d6
status: experimental
description: Detects exploitation attempts of the Log4j 2 vulnerability CVE-2021-44228, which can be identified through logs when an exploit attempt occurs.
references:
  - https://argonsys.com/microsoft-cloud/library/onyx-sleet-uses-array-of-malware-to-gather-intelligence-for-north-korea
author: System Two Security
date: 2024/10/25
tags:
  - attack.initial-access
logsource:
  category: application
  product: jvm
detection:
  keywords:
    - ${jndi:dns://
    - jndi:ldap://
    - jndi:rmi://
    - ${jndi:rmi://
    - ${jndi:ldaps://
    - ${jndi:ldap://
    - jndi:ldaps://
    - jndi:dns://
  condition: keywords
falsepositives:
  - Legitimate applications that use JNDI lookups in a non-malicious context.
level: high
