# review_report_url: https://blog.lumen.com/taking-the-crossroads-the-versa-director-zero-day-exploitation/
# review_date: 2024-10-18
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - The sigma rule correctly matches the exploitation attempt described in the CTI report, focusing on the use of the "p" parameter and "Versa-Auth" header with the hard-coded key 5ea23db511e1ac4a806e002def3b74a1. This aligns with the malicious doFilter hook in Apache Tomcat for the Versa Director Zero-Day. The rule is precise and ready for testing, with low false positive potential due to the specific key involved.
title: Detection of Versa Director Zero-Day Exploitation via doFilter Hook
id: 69409217-8e91-43a1-a369-9f53820a841d
status: experimental
description: Detects a specific malicious activity where a GET or POST request is sent with a "p" request parameter or "Versa-Auth" HTTP header matching a hard-coded key, which is indicative of an exploitation attempt against Apache Tomcat using the Versa Director Zero-Day.
references:
  - https://blog.lumen.com/taking-the-crossroads-the-versa-director-zero-day-exploitation
author: System Two Security
date: 2024/10/11
tags:
  - attack.execution
logsource:
  category: application
  product: jvm
detection:
  selection:
    keywords|all:
      - p=5ea23db511e1ac4a806e002def3b74a1
      - 'Versa-Auth: 5ea23db511e1ac4a806e002def3b74a1'
  condition: selection
falsepositives:
  - Legitimate use of the application with a parameter or header that coincidentally matches the hard-coded key (highly unlikely)
level: critical
