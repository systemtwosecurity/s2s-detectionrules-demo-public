# review_report_url: https://www.ncsc.gov.uk/files/Advisory-APT29-targets-COVID-19-vaccine-development-V1-1.pdf
# review_date: 2024-10-26
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - The sigma rule aligns with the CTI report, listing identical function names like botlib.wellMess and botlib.AES_Encrypt. It monitors ELF and MZ binaries through Windows file events, matching the malwareâ€™s cross-platform behavior. Potential false positives are noted, and the rule is ready for deployment.
title: Detection of WellMess Golang Malware by Function Names
id: 9670f621-cc7b-42ad-b9ba-e08bb766756f
status: experimental
description: Detects the presence of WellMess Golang malware samples based on the function names used by the actor, which are indicative of the malware's capabilities.
references:
  - https://www.ncsc.gov.uk/files/Advisory-APT29-targets-COVID-19-vaccine-development-V1-1.pdf
author: System Two Security
date: 2024/10/25
tags:
  - attack.command-and-control
logsource:
  product: windows
  category: file_event
detection:
  selection:
    MagicHeader|startswith:
      - ELF
      - MZ
  keywords:
    CommandLine|contains|all:
      - botlib.DownloadDNS
      - botlib.Base64ToNormal
      - botlib.CreateDNSName
      - botlib.Send.func1
      - botlib.Service
      - botlib.wellMess
      - botlib.Command
      - botlib.Send
      - botlib.Decipher
      - botlib.RandInt
      - botlib.(*rc6cipher).Decrypt
      - botlib.Unpack
      - botlib.GetRandomBytes
      - botlib.Join
      - botlib.New
      - botlib.reply
      - botlib.SendMessage
      - botlib.JoinDnsChunks
      - botlib.(*rc6cipher).BlockSize
      - botlib.Work
      - botlib.AES_Decrypt
      - botlib.AES_Encrypt
      - botlib.Cipher
      - botlib.chunksM
      - botlib.GenerateSymmKey
      - botlib.FromNormalToBase64
      - botlib.CalculateMD5Hash
      - botlib.deleteFile
      - botlib.RandStringBytes
      - botlib.encrypt
      - botlib.UDFile
      - botlib.Pad
      - botlib.(*KeySizeError).Error
      - botlib.ReceiveMessage
      - botlib.Post
      - botlib.generateRandomString
      - botlib.Download
      - botlib.Key
      - botlib.Split
      - botlib.init
      - botlib.(*rc6cipher).Encrypt
      - botlib.saveFile
      - botlib.convertFromString
      - botlib.KeySizeError.Error
      - botlib.EncryptText
      - botlib.UnpackB
      - botlib.Parse
      - botlib.Pack
      - botlib.SendDNS
  condition: selection and keywords
falsepositives:
  - Legitimate applications using similar function names
  - Development or debugging tools that may use function names for legitimate purposes
level: high
