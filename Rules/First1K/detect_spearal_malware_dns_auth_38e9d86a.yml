# review_report_url: https://research.checkpoint.com/2024/iranian-malware-attacks-iraqi-government/https://research.checkpoint.com/2024/iranian-malware-attacks-iraqi-government/
# review_date: 2024-10-06
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - This Sigma rule aims to detect the initial authentication attempts of the Spearal malware using base32 encoded DNS queries. The rule's relevance and accuracy are high, as it directly corresponds to the specific behavior described in the CTI report. The rule's structure is simple and straightforward, using the query|contains|startswith operator to match DNS queries beginning with "auth:;". This approach aligns well with the CTI content, which states that the initial authentication query starts with "auth:;" before base32 encoding
title: Detect Spearal Malware DNS Initial Authentication
id: 38e9d86a-86ba-4b62-8df2-560e25691782
status: experimental
description: Detects initial authentication attempts by Spearal malware using base32 encoded DNS queries starting with "auth:;"
references:
  - https://research.checkpoint.com/2024/iranian-malware-attacks-iraqi-government
author: System Two Security
date: 2024/10/03
tags:
  - attack.command-and-control
  - attack.t1071.004
logsource:
  product: zeek
  service: dns
detection:
  query:
    query|contains|startswith: auth:;
  condition: query
falsepositives:
  - Legitimate base32 encoded DNS queries that coincidentally start with "auth:;"
level: high
