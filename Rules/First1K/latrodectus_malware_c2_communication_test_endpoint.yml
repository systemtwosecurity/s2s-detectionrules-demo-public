# review_report_url: https://www.netskope.com/blog/latrodectus-rapid-evolution-continues-with-latest-new-payload-features
# review_date: 2024-11-06
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - This Sigma rule targets HTTP POST requests to the "/test" endpoint with specific parameters in the request body, potentially signaling Latrodectus malware attempting to communicate with its command-and-control (C2) server. The presence of particular parameters (e.g., &group=, &arch=, &guid=, and others) aligns with known patterns used by Latrodectus in C2 communications. While some legitimate applications may utilize the "/test" endpoint, this rule focuses on detecting potentially malicious activity with a high level of certainty.
title: Latrodectus Malware C2 Communication via /test Endpoint
id: 81c86171-9f5b-427f-9168-cc5751a27d20
status: experimental
description: Detects the specific pattern of HTTP POST requests to the /test endpoint, which may indicate communication with a C2 server by the Latrodectus malware.
references:
  - https://www.netskope.com/blog/latrodectus-rapid-evolution-continues-with-latest-new-payload-features
author: System Two Security
date: 2024/09/19
tags:
  - attack.command-and-control
logsource:
  category: application
  product: modsecurity
detection:
  selection:
    c-uri|endswith: /test
    cs-method: POST
    c-request-body|contains|all:
      - '&group='
      - '&arch='
      - '&guid='
      - '&type='
      - counter=
      - '&direction='
      - '&os='
      - '&dup='
      - '&username='
  condition: selection
falsepositives:
  - Legitimate applications that use the same endpoint for benign purposes
level: high
