# review_author: Blackperl
# review_date: 2024-12-11
# review_report_url: https://cloud.google.com/blog/topics/threat-intelligence/apt41-arisen-from-dust
# review_rule_useful: Yes
# review_rule_classification: Proceed to testing
# review_rule_ttp_match: Yes
# review_notes: This rule detects APT41 malware families (DUSTPAN, DUSTTRAP, PINEGROVE, SQLULDR2) by matching image load events with known malicious MD5 hashes on Windows systems. It monitors specific files loaded into memory, correlating with threat intelligence reports. False positives are unlikely due to the precision of hash-based detection. Regular updates to hashes are required for sustained effectiveness.

title: APT41 DUSTPAN, DUSTTRAP, PINEGROVE, and SQLULDR2 Malware
id: 6c663fe7-c948-4b1a-8b19-a7a24286152b
status: experimental
description: Detects the presence of files associated with APT41's DUSTPAN, DUSTTRAP, PINEGROVE, and SQLULDR2 malware families based on MD5 hashes.
references:
  - https://cloud.google.com/blog/topics/threat-intelligence/apt41-arisen-from-dust
author: System Two Security
date: 2024/11/28
tags:
  - attack.discovery
logsource:
  product: windows
  category: image_load
detection:
  selection:
    md5|contains:
      - 393065ef9754e3f39b24b2d1051eab61
      - c33247bc3e7e8cb72133e47930e6ddad
      - 0e74285f3359393e57f5d49c156aca47
      - fcff642268898fcf65702a214aefbf9e
      - 35f650c94faf6a2068e8238dd99edbea
      - ac125aea0b703de37980779599438b4a
      - e584119a4766e6cf49093c666965c8be
      - 17d0ada8f5610ff29f2e8eaf0e3bb578
      - 9991ce9d2746313f505dbf0487337082
      - 336a0d6f8cc92bf9740ce17de600463b
      - dc725f5e9b1ae062fbec86ee4d816b45
      - e98b9e21928252332edf934f3d18ac21
      - 8222352a61eacca3a1c6517956aa0b55
      - d72f202c1d684c9a19f075290a60920f
      - 3bb44c0dd7f424864d76d4df09538cb6
      - 6bc4a92ff4d2cfc9da91ae6a5d2ad3d5
      - a689e182fe33b9d564dddc35412ea0a7
      - aca5c6daecf463012a09564764584937
      - cfce85548436fb89a83bf34dc17f325d
      - e4a4aafb49b8c86a5ac087ae342c0ee6
      - f1769ad5a9dc44794895275c656ed484
  condition: selection
falsepositives:
  - Legitimate use of tools with the same MD5 hash (unlikely)
level: high
