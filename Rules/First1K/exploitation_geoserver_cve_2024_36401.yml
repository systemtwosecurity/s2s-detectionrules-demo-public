# review_report_url: Threat Actors Exploit GeoServer Vulnerability CVE-2024-36401 | FortiGuard Labs (fortinet.com)
# review_date: 2024-10-08
# review_author: Blackpearl
# review_rule_useful: true
# review_rule_classification: proceed to testing
# review_rule_classification_reason: na
# review_rule_ttp_match: yes
# review_notes:
#  - This Sigma rule aims to detect exploitation attempts of the GeoServer vulnerability CVE-2024-36401, which allows arbitrary code execution through a specific HTTP GET request. The rule's relevance and accuracy are high, as it directly addresses the attack vector described in the CTI report, focusing on the unique parameters used in the exploit. The detection logic effectively captures the key elements of the malicious request, including the targeted endpoint, version, and specific payload components.The rule incorporates specific IOCs from the CTI, such as the "valueReference" parameter and encoded bash commands
title: Exploitation of GeoServer Vulnerability CVE-2024-36401
id: 069d4a92-7c70-4b19-994d-d14d6b21a728
status: experimental
description: Detects exploitation attempts targeting GeoServer vulnerability CVE-2024-36401 by using a specific HTTP GET request to execute arbitrary code via the "valueReference" parameter.
references:
  - https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401
author: System Two Security
date: 2024/09/20
tags:
  - attack.persistence
logsource:
  category: application
  product: modsecurity
detection:
  selection:
    c-uri|contains|all:
      - /geoserver/wfs
      - version=2.0.0
      - request=GetPropertyValueTypeNames
      - '|{base64,-d}'
      - valueReference=exec(java.lang.Runtime.getRuntime(),
      - '|{bash,-i}'
      - bash+-c+{echo,
      - Y3VyCAXmTUMtMzMzLjE5NC4yNTQvY3JvbW1zaZacCB8IGJhc2g=}
      - service=WFS
  condition: selection
falsepositives:
  - Legitimate GeoServer development or testing activities that use similar parameters in the GET request.
level: critical
